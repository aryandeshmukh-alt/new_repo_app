<div class="blog-header-info">
  <div class="d-flex justify-content-between align-items-start">
    <div class="flex-grow-1">
      <h1 class="blog-title"><%= @blog.title %></h1>
      <div class="blog-meta">
        <span class="blog-meta-item">
          <strong><%= @blog.user.email %></strong>
        </span>
        <span class="blog-meta-item">
          <%= @blog.created_at.strftime("%B %d, %Y") %>
        </span>
        <span class="blog-meta-item">
          <span class="badge <%= @blog.published? ? 'bg-success' : 'bg-warning text-dark' %>">
            <%= @blog.published? ? "Published" : "Draft" %>
          </span>
        </span>
      </div>
    </div>
    <% if current_user == @blog.user %>
      <div class="btn-group ms-3">
        <% unless @blog.published %>
          <%= button_to "Publish",
                publish_blog_path(@blog),
                method: :patch,
                class: "btn btn-success btn-sm" %>
        <% end %>
        <%= link_to "Edit", edit_blog_path(@blog), class: "btn btn-primary btn-sm" %>
        <%= button_to "Delete",
              @blog,
              method: :delete,
              data: { confirm: "Are you sure?" },
              class: "btn btn-danger btn-sm" %>
      </div>
    <% end %>
  </div>
</div>

<article class="blog-content mb-5">
  <%= simple_format(@blog.body) %>
</article>

<section class="comments-section">
  <h3 class="comments-header">Comments</h3>

  <% if @blog.comments.any? %>
    <div class="mb-4">
      <%= render partial: "comments/comment",
                 collection: @blog.comments,
                 locals: { blog: @blog } %>
    </div>
  <% else %>
    <div class="alert alert-info">
      No comments yet. Be the first to share your thoughts!
    </div>
  <% end %>

  <% if @blog.published? && user_signed_in? %>
    <div class="mt-4">
      <%= render "comments/form", blog: @blog %>
    </div>
  <% elsif @blog.published? %>
    <div class="alert alert-warning mt-4">
      <%= link_to "Sign in", new_user_session_path, class: "alert-link fw-600" %> to leave a comment
    </div>
  <% end %>
</section>

<div class="mt-5 pt-3 border-top">
  <%= link_to "Back to Posts", blogs_path, class: "btn btn-outline-secondary" %>
</div>
